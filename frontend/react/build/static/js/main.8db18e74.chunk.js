(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{130:function(e,t,n){},131:function(e,t,n){},244:function(e,t,n){"use strict";n.r(t);var r,c,i=n(3),s=n.n(i),a=n(110),o=n.n(a),l=(n(130),n(131),n(253)),d=n(254),j=n(252),b=n(23),u=n(255),m=n(247),O=n(120),p=n(1),h=Object(u.a)(r||(r=Object(b.a)(["\n  query TotalPermits($sourceId: Int) {\n    permits(condition: { sourceId: $sourceId }) {\n      totalCount\n    }\n  }\n"]))),x=Object(u.a)(c||(c=Object(b.a)(["\n  query TotalPermits($sourceId: Int, $classification: Classification) {\n    permits(\n      condition: { sourceId: $sourceId, classification: $classification }\n    ) {\n      totalCount\n    }\n  }\n"])));var C,f=function(e){var t=e.source.id,n=Object(m.a)(h,{variables:{sourceId:t}}),r=Object(m.a)(x,{variables:{sourceId:t,classification:"UNCLASSIFIED"}}),c=Object(m.a)(x,{variables:{sourceId:t,classification:"CONSTRUCTION"}}),i=Object(m.a)(x,{variables:{sourceId:t,classification:"NOT_CONSTRUCTION"}}),s=Object(m.a)(x,{variables:{sourceId:t,classification:"POSSIBLE_CONSTRUCTION"}}),a=Object(m.a)(x,{variables:{sourceId:t,classification:"DUPLICATE"}});if(n.loading||r.loading||c.loading||i.loading||s.loading||a.loading)return Object(p.jsx)("p",{children:"Loading..."});if(n.error)return Object(p.jsx)("p",{children:"Error with Total"});if(r.error)return Object(p.jsx)("p",{children:"Error with unclassified"});if(c.error)return Object(p.jsx)("p",{children:"Error with consruction"});if(i.error)return Object(p.jsx)("p",{children:"Error with not consruction"});if(s.error)return Object(p.jsx)("p",{children:"Error with possible consruction"});if(a.error)return Object(p.jsx)("p",{children:"Error with duplicate"});var o={labels:["Unclassified","Construction","Not Construction","Possible Construction","Duplicate"],datasets:[{label:"Rainfall",backgroundColor:["#B21F00","#C9DE00","#2FDE00","#00A6B4","#6800B4"],hoverBackgroundColor:["#501800","#4B5000","#175000","#003350","#35014F"],data:[r.data.permits.totalCount,c.data.permits.totalCount,i.data.permits.totalCount,s.data.permits.totalCount,a.data.permits.totalCount]}]};return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"statBox",children:[Object(p.jsx)("h2",{className:"text-center",children:e.source.name}),Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-4",children:[Object(p.jsxs)("p",{children:["Permits: ",n.data.permits.totalCount]}),Object(p.jsxs)("p",{children:["Unclassified: ",r.data.permits.totalCount]}),Object(p.jsxs)("p",{children:["Construction: ",c.data.permits.totalCount]}),Object(p.jsxs)("p",{children:["Not Construction: ",i.data.permits.totalCount]}),Object(p.jsxs)("p",{children:["Possible Construction:"," ",s.data.permits.totalCount]}),Object(p.jsxs)("p",{children:["Duplicate: ",a.data.permits.totalCount]})]}),Object(p.jsx)("div",{className:"col-8",children:Object(p.jsx)(O.a,{className:"chart",data:o})})]})]})})},y=Object(u.a)(C||(C=Object(b.a)(["\n  query GetAllSources {\n    sources {\n      nodes {\n        description\n        id\n        name\n      }\n    }\n  }\n"])));var g=function(){var e=Object(m.a)(y),t=e.loading,n=e.error,r=e.data;return t?Object(p.jsx)("p",{children:"Loading..."}):n?Object(p.jsx)("p",{children:"Error :("}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"text-center",children:"Source Statistics"}),Object(p.jsx)("div",{className:"row",children:r.sources.nodes.map((function(e){return Object(p.jsx)("div",{className:"col-md-4",children:Object(p.jsx)(f,{source:e})})}))}),Object(p.jsx)("script",{src:"https://cdn.jsdelivr.net/npm/chart.js"})]})},v=n(10),N=n(251),F=n(49);var S=function(e){var t=Object(i.useState)(""),n=Object(v.a)(t,2),r=n[0],c=n[1],s=Object(i.useState)(""),a=Object(v.a)(s,2),o=a[0],l=a[1],d=Object(i.useState)(""),j=Object(v.a)(d,2),b=j[0],u=j[1],m=Object(i.useState)(""),O=Object(v.a)(m,2),h=O[0],x=O[1],C=Object(i.useState)(""),f=Object(v.a)(C,2),y=f[0],g=f[1],N=Object(i.useState)(""),F=Object(v.a)(N,2),S=F[0],I=F[1],E=Object(i.useState)("ALL"),T=Object(v.a)(E,2),k=T[0],D=T[1],w=Object(i.useState)("SQFT_DESC"),B=Object(v.a)(w,2),L=B[0],U=B[1];function $(t){var n;t&&t.preventDefault(),n="ALL"===k?void 0:{equalTo:k},e.setFilterVars({order:L,classification:n,min_sqft:Number(S),min_cost:Number(y),street:r,city:o,state:b,zip:h})}return Object(i.useEffect)((function(){$()}),[k,L]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h5",{children:"Filter By:"}),Object(p.jsx)("div",{className:"container-fluid",children:Object(p.jsx)("form",{onSubmit:$,children:Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-lg-8",children:[Object(p.jsxs)("div",{className:"form-row",children:[Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"streetFilter",children:"Street:"}),Object(p.jsx)("input",{value:r,onChange:function(e){return c(e.target.value)},type:"text",className:"my-1 mr-2 form-control",id:"streetFilter"})]}),Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"cityFilter",children:"City:"}),Object(p.jsx)("input",{value:o,onChange:function(e){return l(e.target.value)},type:"text",className:"form-control my-1 mr-2",id:"cityFilter"})]}),Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"stateFilter",children:"State:"}),Object(p.jsx)("input",{value:b,onChange:function(e){return u(e.target.value)},type:"text",className:"form-control my-1 mr-2",id:"stateFilter"})]}),Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"zipFilter",children:"Zip:"}),Object(p.jsx)("input",{value:h,onChange:function(e){return x(e.target.value)},type:"text",className:"form-control my-1 mr-2",id:"zipFilter"})]})]}),Object(p.jsxs)("div",{className:"form-row",children:[Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"classification_filter",children:"Classification:"}),Object(p.jsxs)("select",{className:"custom-select my-1 mr-sm-2",id:"classification_filter",value:k,onChange:function(e){D(e.target.value)},children:[Object(p.jsx)("option",{value:"ALL",children:"All"}),Object(p.jsx)("option",{value:"UNCLASSIFIED",children:"Unclassified"}),Object(p.jsx)("option",{value:"CONSTRUCTION",children:"Construction"}),Object(p.jsx)("option",{value:"NOT_CONSTRUCTION",children:"Not Construction"}),Object(p.jsx)("option",{value:"POSSIBLE_CONSTRUCTION",children:"Maybe Construction"}),Object(p.jsx)("option",{value:"DUPLICATE",children:"Duplicate"})]})]}),Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"minCostFilter",children:"Min Cost:"}),Object(p.jsx)("input",{value:y,onChange:function(e){return g(e.target.value)},type:"number",className:"form-control my-1 mr-2",id:"minCostFilter",placeholder:"$0"})]}),Object(p.jsxs)("div",{className:"form-col",children:[Object(p.jsx)("label",{className:"my-1 mr-2",htmlFor:"minSqftFilter",children:"Min Square Footage:"}),Object(p.jsx)("input",{value:S,onChange:function(e){return I(e.target.value)},type:"number",className:"form-control my-1 mr-2",id:"minSqftFilter",placeholder:"0"})]}),Object(p.jsx)("div",{className:"form-col",children:Object(p.jsxs)("div",{style:{marginTop:"35px",marginLeft:"10px"},children:[Object(p.jsx)("input",{type:"submit",className:"btn btn-primary mb-2",value:"Apply"}),Object(p.jsx)("button",{type:"button",className:"btn btn-link",onClick:function(){document.getElementById("backdrop").style.display="block",document.getElementById("curlModal").style.display="block",document.getElementById("curlModal").classList.add("show")},"data-toggle":"tooltip","data-placement":"top",title:"view cURL instructions",children:Object(p.jsx)("h4",{children:Object(p.jsx)("i",{className:"bi bi-info-circle"})})}),Object(p.jsx)("button",{onClick:e.getJsonFile,className:"btn btn-link","data-toggle":"tooltip","data-placement":"top",title:"view raw JSON",children:Object(p.jsx)("h4",{children:Object(p.jsx)("i",{className:"bi bi-file-earmark-code"})})})]})})]})]}),Object(p.jsx)("div",{className:"col-lg-auto"}),Object(p.jsxs)("div",{className:"col-lg-3",children:[Object(p.jsx)("h5",{children:"Order By:"}),Object(p.jsxs)("select",{value:L,onChange:function(e){return U(e.target.value)},className:"custom-select my-1 mr-sm-2",id:"selectOrder",children:[Object(p.jsx)("option",{value:"SQFT_DESC",children:"Size"}),Object(p.jsx)("option",{value:"COST_DESC",children:"Cost"})]})]})]})})})]})};var I,E=function(e){return Object(p.jsx)("table",{className:"col-lg-3 col-md-auto permitDataTable",style:{border:e.border,backgroundColor:e.backgroundColor},children:Object(p.jsxs)("tbody",{children:[Object(p.jsx)("tr",{children:Object(p.jsx)("td",{children:Object(p.jsx)("h5",{children:"Permit Data"})})}),Object(p.jsx)("tr",{children:Object(p.jsx)("td",{children:e.permit.permitData&&Object.entries(function(e){var t=JSON.parse(e);return["Accuracy Score","Accuracy Type","Bldg Sqft","City","County","Country","Estimated Construction Cost","Latitude","Longitude","Number","Site Location","Source","State","Street","Unit Type","Unit Number","Zip"].forEach((function(e){delete t[e]})),t}(e.permit.permitData)).map((function(e){var t=Object(v.a)(e,2),n=t[0],r=t[1];return Object(p.jsxs)(s.a.Fragment,{children:[Object(p.jsxs)("b",{children:[n,":"]})," ",r,Object(p.jsx)("br",{})]},n)}))})})]})})},T=n(257);var k,D=function(e){var t=Object(u.a)(I||(I=Object(b.a)(["\n    mutation UpdateNotes($note: String, $id: Int!) {\n      updatePermit(input: { patch: { notes: $note }, id: $id }) {\n        clientMutationId\n        permit {\n          notes\n        }\n      }\n    }\n  "]))),n=Object(i.useState)(e.permit.notes||""),r=Object(v.a)(n,2),c=r[0],s=r[1],a=Object(T.a)(t),o=Object(v.a)(a,2),l=o[0],d=o[1],j=(d.data,d.loading,d.error);return Object(i.useEffect)((function(){l({variables:{note:c,id:e.permit.id}})}),[c]),j&&console.log(j),Object(p.jsx)("div",{className:"form-group",children:Object(p.jsx)("textarea",{className:"form-control",style:{width:"100%"},id:"notes-"+e.permit.id,rows:"2",placeholder:"Enter a note",value:c,onChange:function(e){return s(e.target.value)}})})},w=n(85),B=n.n(w),L=n(116),U=Object(u.a)(k||(k=Object(b.a)(["\n  mutation classifyPermit($id: Int!, $classification: Classification) {\n    updatePermit(\n      input: { patch: { classification: $classification }, id: $id }\n    ) {\n      clientMutationId\n      permit {\n        id\n        classification\n      }\n    }\n  }\n"]))),$={border:"8px solid #EEE",backgroundColor:"#FFFFFF"},q={border:"8px solid #00CC00",backgroundColor:"#CCFFCC"},P={border:"8px solid #FF0000",backgroundColor:"#FFCCCC"},R={border:"8px solid #DDDD00",backgroundColor:"#FFFF99"},_={border:"8px solid #FF0000",backgroundColor:"#FFCCCC"};var A=function(e){var t=Object(T.a)(U),n=Object(v.a)(t,2),r=n[0],c=n[1];function i(e){return s.apply(this,arguments)}function s(){return(s=Object(L.a)(B.a.mark((function t(n){return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({variables:{id:e.permit.id,classification:n}});case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return c.data,c.loading,c.error,Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t;t=e.permit.id,document.getElementById(t).style.border=P.border,document.getElementById(t).style.backgroundColor=P.backgroundColor,i("NOT_CONSTRUCTION")},children:[Object(p.jsx)("u",{children:"N"}),"o"]}),Object(p.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t;t=e.permit.id,document.getElementById(t).style.border=q.border,document.getElementById(t).style.backgroundColor=q.backgroundColor,i("CONSTRUCTION")},children:[Object(p.jsx)("u",{children:"Y"}),"es"]}),Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t;t=e.permit.id,document.getElementById(t).style.border=R.border,document.getElementById(t).style.backgroundColor=R.backgroundColor,i("POSSIBLE_CONSTRUCTION")},children:"Maybe"}),Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t;t=e.permit.id,document.getElementById(t).style.border=_.border,document.getElementById(t).style.backgroundColor=_.backgroundColor,i("DUPLICATE")},children:"Duplicate"}),Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t;t=e.permit.id,document.getElementById(t).style.border=$.border,document.getElementById(t).style.backgroundColor=$.backgroundColor,i("UNCLASSIFIED")},children:"Reset"})]})};var M=function(e){var t={UNCLASSIFIED:{border:"8px solid #EEE",backgroundColor:"#FFFFFF"},CONSTRUCTION:{border:"8px solid #00CC00",backgroundColor:"#CCFFCC"},NOT_CONSTRUCTION:{border:"8px solid #FF0000",backgroundColor:"#FFCCCC"},POSSIBLE_CONSTRUCTION:{border:"8px solid #DDDD00",backgroundColor:"#FFFF99"},DUPLICATE:{border:"8px solid #FF0000",backgroundColor:"#FFCCCC"},HIGHLIGHT:{border:"8px solid #999",backgroundColor:"#EEEEEE"}},n="/data/",r=n+e.permit.id+".mp4",c=t[e.permit.classification].border,i=t[e.permit.classification].backgroundColor,a=e.permit.streetNumber+" "+e.permit.street+", "+e.permit.city+", "+e.permit.state+" "+e.permit.zip;return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:"row",children:Object(p.jsxs)("div",{className:"row align-items-center",children:[Object(p.jsx)("table",{className:"col-lg-8 col-md-auto",style:{border:c,backgroundColor:i},id:e.permit.id,children:Object(p.jsx)("tbody",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:Object(p.jsxs)("video",{autoPlay:!0,loop:!0,muted:!0,controls:!0,children:[Object(p.jsx)("source",{src:r,type:"video/mp4"}),"Your browser does not support the video tag."]})}),Object(p.jsxs)("td",{style:{width:"500px"},children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:a}),Object(p.jsx)("br",{}),"Cost: ",Object(p.jsx)("b",{children:e.permit.cost}),"Sqft: ",Object(p.jsx)("b",{children:e.permit.sqft}),Object(p.jsx)("br",{}),"(",e.permit.location.x,", ",e.permit.location.y,")",Object(p.jsx)("br",{}),"id: ",e.permit.id,Object(p.jsx)("p",{}),Object(p.jsx)("p",{}),"Construction?",Object(p.jsx)("p",{}),Object(p.jsx)(A,{permit:e.permit}),Object(p.jsx)("p",{}),Object(p.jsx)(D,{permit:e.permit})]}),Object(p.jsx)("td",{children:["2016","2017","2018","2019","2020","2021"].map((function(t){return Object(p.jsxs)(s.a.Fragment,{children:[Object(p.jsx)("a",{href:n+e.permit.id+" "+t+"-07-01.kml",children:t}),Object(p.jsx)("br",{})]},t)}))})]})})}),Object(p.jsx)(E,{permit:e.permit,border:c,backgroundColor:i})]})})})};var z,J=function(e){function t(){document.getElementById("backdrop").style.display="none",document.getElementById("curlModal").style.display="none",document.getElementById("curlModal").classList.remove("show")}var n=document.getElementById("curlModal");return window.onclick=function(e){e.target==n&&t()},Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"modal fade",id:"curlModal",tabIndex:"-1",children:Object(p.jsx)("div",{className:"modal-dialog",children:Object(p.jsxs)("div",{className:"modal-content",children:[Object(p.jsxs)("div",{className:"modal-header",children:[Object(p.jsx)("h5",{className:"modal-title",id:"curlModalLabel",children:"Using cURL"}),Object(p.jsx)("button",{type:"button",className:"close","aria-label":"Close",onClick:t,children:Object(p.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(p.jsx)("div",{className:"modal-body",children:Object(p.jsxs)("code",{children:["curl -g --user admin:admin \\",Object(p.jsx)("br",{}),"-X POST \\",Object(p.jsx)("br",{}),'-H "Content-Type: application/json" \\',Object(p.jsx)("br",{}),'-d \'{"query": ',e.query,', "variables": ',e.variables,',"operationName":"MyQuery"}\' \\',Object(p.jsx)("br",{}),"http://smart.dzynetech.com:4401/graphql"]})}),Object(p.jsx)("div",{className:"modal-footer",children:Object(p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Close"})})]})})}),Object(p.jsx)("div",{className:"modal-backdrop fade show",id:"backdrop",style:{display:"none"}})]})},H=Object(u.a)(z||(z=Object(b.a)(['\n  query MyQuery(\n    $order: [PermitsOrderBy!]\n    $classification: ClassificationFilter\n    $min_sqft: Float\n    $min_cost: Float\n    $city: String\n    $street: String\n    $state: String\n    $zip: String\n  ) {\n    permits(\n      orderBy: $order\n      filter: {\n        and: {\n          imageUrl: { isNull: false }\n          sqft: { greaterThanOrEqualTo: $min_sqft }\n          cost: { greaterThanOrEqualTo: $min_cost }\n          classification: $classification\n          # sourceId\n          city: { includesInsensitive: $city }\n          street: { includesInsensitive: $street }\n          state: { includesInsensitive: $state }\n          zip: { includesInsensitive: $zip }\n          hasLocation: { equalTo: true }\n          and: {\n            or: [\n              { permitData: { includes: "COMOTH" } }\n              { permitData: { includes: "COMRET" } }\n              { permitData: { includes: "Commercial" } }\n              { permitData: { includes: "New Construction" } }\n              { permitData: { includes: "NEWCON" } }\n              { permitData: { includes: "ERECT" } }\n            ]\n          }\n        }\n      }\n    ) {\n      edges {\n        node {\n          id\n          cost\n          city\n          sqft\n          state\n          street\n          streetNumber\n          source {\n            name\n          }\n          location {\n            x\n            y\n          }\n          zip\n          permitData\n          classification\n          notes\n        }\n      }\n      totalCount\n    }\n  }\n'])));var Q=function(){var e=Object(i.useState)({}),t=Object(v.a)(e,2),n=t[0],r=t[1],c=Object(N.a)(H),s=Object(v.a)(c,2),a=s[0],o=s[1],l=(o.loading,o.error),d=o.data;return Object(i.useEffect)((function(){a({variables:n}),l&&console.log(l)}),[n]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"Construction sites"}),Object(p.jsx)("h3",{children:"Permits: 2017 - 2019"}),Object(p.jsx)(S,{setFilterVars:r,getJsonFile:function(){var e=JSON.stringify(d),t=new Blob([e],{type:"text/plain"}),n=window.URL.createObjectURL(t);window.location.href=n}}),d&&Object(p.jsxs)("p",{children:["Filter returned ",d.permits.totalCount," results"]}),Object(p.jsx)(J,{query:JSON.stringify(Object(F.a)(H)),variables:JSON.stringify(n)}),Object(p.jsx)("div",{id:"home",style:{minHeight:"1000px",position:"relative"},children:d&&d.permits.edges.map((function(e){return Object(p.jsx)(M,{permit:e.node},e.node.id)}))}),Object(p.jsx)("script",{src:"https://code.jquery.com/jquery-3.3.1.min.js"}),Object(p.jsx)("script",{src:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"})]})},G=n(117),V=n(11),Y=new l.a({uri:"http://localhost:3000/graphql",cache:new d.a});var Z=function(){return Object(p.jsx)(j.a,{client:Y,children:Object(p.jsx)("div",{className:"App container-fluid",children:Object(p.jsx)(G.a,{children:Object(p.jsxs)(V.c,{children:[Object(p.jsx)(V.a,{path:"/stats",children:Object(p.jsx)(g,{})}),Object(p.jsx)(V.a,{path:"/",children:Object(p.jsx)(Q,{})})]})})})})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,258)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),i(e),s(e)}))};o.a.render(Object(p.jsx)(Z,{}),document.getElementById("root")),W()}},[[244,1,2]]]);
//# sourceMappingURL=main.8db18e74.chunk.js.map